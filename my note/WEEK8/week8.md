# ğŸ“ç³»çµ±ç¨‹å¼ç¬¬å…«é€±ç­†è¨˜20210421
## ğŸ“– ä½œæ¥­ç³»çµ±
### ğŸ”– å¸¸è¦‹ä½œæ¥­ç³»çµ±
![](pic/ä½œæ¥­ç³»çµ±åœ–.jpg)

### ğŸ”– äº”å¤§åŠŸèƒ½æ¨¡çµ„
#### 1.è¡Œç¨‹ç®¡ç†
* æ‰“é€ å‡ºä¸€å€‹ç’°å¢ƒï¼Œè®“ä»»ä½•ç³»çµ±èƒ½è¼•æ˜“åœ°åŸ·è¡Œï¼Œè€Œä¸å—åˆ°å…¶ä»–ç¨‹å¼å¹²æ“¾
#### 2.è¨˜æ†¶é«”ç®¡ç†
* æ‰“é€ å‡ºä¸€å€‹è¨˜æ†¶é«”é…ç½®ç’°å¢ƒï¼Œç•¶æˆæ˜¯éœ€è¦è¨˜æ†¶é«”åï¼Œåªè¦é€éç³»çµ±å‘¼å«æå‡ºè«‹æ±‚ï¼Œå°±å¯ä»¥ç²å¾—æ‰€è¦çš„è¨˜æ†¶é«”ç©ºé–“ï¼Œå®Œå…¨ä¸ç”¨å»è€ƒæ…®å…¶ä»–åŸå¸‚æ˜¯å¦å­˜åœ¨ï¼Œæˆ–è€…æ‡‰è©²ç”¨å“ªä¸€å€‹å€åŸŸçš„è¨˜æ†¶é«”ç­‰å•é¡Œ
#### 3.è¼¸å‡ºå…¥ç®¡ç†
* å°‡è¼¸å…¥è£ç½®åŒ…è£æˆå‡½ç¤ºåº«ï¼Œè®“åŸå¸‚å¸«éƒ¨ç”¨ç›´æ¥é¢å°è¤‡é›œä¸”å¤šæ¨£çš„è£ç½®ã€‚
#### 4.æª”æ¡ˆç³»çµ±
* æ˜¯è¼¸å‡ºå…¥ç³»çš„å»¶ä¼¸ï¼Œä¸»è¦é‡å°æ°¸ä¹…é™¤ç´”è£ç½®çš„è¨­è¨ˆï¼Œç›®çš„æ˜¯è®“åŸå¸‚æ–½äºˆä½¿ç”¨è€…èƒ½è¼•æ˜“å­˜å–è³‡æ–™ï¼Œè€Œä¸éœ€è€ƒæ…®å„ç¨®ä¸åŒå„²å­˜è£ç½®çš„æŠ€è¡“ç´°ç¯€
* ç¨‹å¼è¨­è¨ˆå¸«åªè¦é€éä½œæ¥­ç³»çµ±æ‰€æä¾›çš„ï¼‚æª”æ¡ˆè¼¸å‡ºå…¥å‡½æ•¸ï¼‚å°±èƒ½å­˜å–æª”æ¡ˆ
* ä¸€èˆ¬ä½¿ç”¨è€…åªè¦é€éï¼‚å‘½ä»¤åˆ—ï¼‚æˆ–ï¼‚è¦–çª—ä»‹é¢ï¼‚å°±èƒ½å­˜å–æª”æ¡ˆ
#### 5.ä½¿ç”¨è€…ä»‹é¢
* è¦–çª—ä»‹é¢è¢«ç™¼æ˜å¾Œï¼Œé€æ¼¸å–ä»£å‘½ä»¤åˆ—ä»‹é¢ï¼Œæˆç‚ºä¸»è¦çš„ä½¿ç”¨è€…ä»‹é¢

## ğŸ“– [è¡Œç¨‹(process)](https://zh.wikipedia.org/wiki/%E8%A1%8C%E7%A8%8B)
### ğŸ”– æ¦‚è¿°
* å¤šé“ç¨‹åºåœ¨åŸ·è¡Œæ™‚ï¼Œéœ€è¦å…±äº«ç³»ç»Ÿè³‡æºï¼Œå¾è€Œå°è‡´å„ç¨‹åºåœ¨åŸ·è¡Œéç¨‹ä¸­å‡ºç¾ç›¸äº’åˆ¶ç´„çš„é—œä¿‚ï¼Œç¨‹åºçš„åŸ·è¡Œè¡¨ç¾å‡ºé–“æ–·æ€§çš„ç‰¹å¾µã€‚é€™äº›ç‰¹å¾µéƒ½æ˜¯åœ¨ç¨‹åºçš„åŸ·è¡Œéç¨‹ä¸­ç™¼ç”Ÿçš„ï¼Œæ˜¯å‹•æ…‹çš„éç¨‹ï¼Œè€Œå‚³ç»Ÿçš„ç¨‹åºæœ¬èº«æ˜¯ä¸€ç»„æŒ‡ä»¤çš„é›†åˆï¼Œæ˜¯ä¸€ä¸ªéœæ…‹çš„æ¦‚å¿µï¼Œç„¡æ³•æè¿°ç¨‹åºåœ¨å†…å­˜ä¸­çš„åŸ·è¡Œæƒ…å†µï¼Œå³æˆ‘å€‘ç„¡æ³•å¾ç¨‹åºçš„å­—é¢ä¸Šçœ‹å‡ºå®ƒä½•æ™‚åŸ·è¡Œï¼Œä½•æ—¶åœé “ï¼Œä¹Ÿç„¡æ³•çœ‹å‡ºå®ƒèˆ‡å…¶å®ƒåŸ·è¡Œç¨‹åºçš„é—œä¿‚ï¼Œå› æ­¤ï¼Œç¨‹åºé€™å€‹é™æ…‹æ¦‚å¿µå·²ä¸èƒ½å¦‚å¯¦åæ˜ ç¨‹åºä¸¦ç™¼åŸ·è¡Œéç¨‹çš„ç‰¹å¾µ

### ğŸ”– æ¦‚å¿µ
* è¡Œç¨‹æ˜¯ä¸€å€‹å¯¦é«”ã€‚æ¯ä¸€å€‹è¡Œç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„åœ°å€ç©ºé–“
* è¡Œç¨‹æ˜¯ä¸€å€‹â€œåŸ·è¡Œä¸­çš„ç¨‹åºâ€ã€‚ç¨‹åºæ˜¯ä¸€å€‹æœ‰ç”Ÿå‘½çš„å¯¦é«”ï¼Œåªæœ‰è™•ç†å™¨è³¦äºˆç¨‹åºç”Ÿå‘½æ™‚ï¼Œå®ƒæ‰èƒ½æˆç‚ºä¸€å€‹æ´»å‹•çš„å¯¦é«”

### ğŸ”– è¡Œç¨‹è¨˜æ†¶é«”çµæ§‹
![](pic/è¡Œç¨‹è¨˜æ†¶é«”çµæ§‹.jpg)
* è¡Œç¨‹ä¸åªæ˜¯ç¨‹å¼ç¢¼ ï¼Œæœ‰æ™‚ä¹Ÿç¨±ç‚ºæœ¬æ–‡å€(text section)ã€‚
* å®ƒåŒ…å«ä»£è¡¨ç›®å‰é‹ä½œçš„ç¨‹å¼è¨ˆæ•¸å™¨ (program counter)æ•¸å€¼å’Œè™•ç†å™¨(processor)çš„æš«å­˜å™¨(registrers)å…§å®¹ã€‚
* è¡Œç¨‹å †ç–Š (stack)ï¼šå­˜æ”¾æš«ç”¨è³‡æ–™ (å‰¯ç¨‹å¼çš„åƒæ•¸ã€è¿”å›ä½å€ï¼ŒåŠæš«æ™‚æ€§è®Šæ•¸)
* è³‡æ–™å€é–“(data section)ï¼šåŒ…å«å…¨åŸŸè®Šæ•¸(global variables)
* å †ç© (heap)ï¼šå †ç©å°±æ˜¯åœ¨è¡Œç¨‹åŸ·è¡ŒæœŸé–“å‹•æ…‹é…ç½®çš„è¨˜æ†¶é«”ã€‚

### ğŸ”– è¡Œç¨‹ç‹€æ…‹
![](pic/è¡Œç¨‹ç‹€æ…‹åœ–.jpg)
è¡Œç¨‹çš„åŸºæœ¬ç‹€æ…‹æœ‰ä¸‰ç¨®ï¼šå°±ç·’ã€åŸ·è¡Œã€ç­‰å¾…(é˜»å¡)ã€‚
* å°±ç·’ç‹€æ…‹ï¼šç•¶è¡Œç¨‹å·²åˆ†é…åˆ°é™¤CPUä»¥å¤–çš„æ‰€æœ‰å¿…è¦è³‡æºå¾Œï¼Œåªè¦åœ¨ç²å¾—CPUï¼Œä¾¿å¯ç«‹å³åŸ·è¡Œï¼Œè¡Œç¨‹é€™æ™‚çš„ç‹€æ…‹ç¨±ç‚ºå°±ç·’ç‹€æ…‹ã€‚è™•æ–¼è©²ç‹€æ…‹çš„è¡Œç¨‹æ§‹æˆç·’åˆ—éšŠã€‚
* åŸ·è¡Œç‹€æ…‹ï¼šè¡Œç¨‹æ­£åœ¨è™•ç†å™¨ä¸Šé‹è¡Œçš„ç‹€æ…‹ï¼Œè©²è¡Œç¨‹å·²ç²å¾—å¿…è¦çš„è³‡æºï¼Œä¹Ÿç²å¾—äº†è™•ç†å™¨ï¼Œç”¨æˆ¶ç¨‹åºæ­£åœ¨è™•ç†å™¨ä¸Šé‹è¡Œã€‚
* ç­‰å¾…(é˜»å¡)ç‹€æ…‹ï¼šæ­£åœ¨åŸ·è¡Œçš„è¡Œç¨‹ç”±æ–¼ç™¼ç”ŸæŸäº‹ä»¶è€Œæš«æ™‚ç„¡æ³•ç¹¼çºŒåŸ·è¡Œæ™‚ï¼Œè®Šæ”¾æ£„è™•ç†å™¨è€Œè™•æ–¼æš«åœç‹€æ…‹ï¼Œå³è¡Œç¨‹çš„åŸ·è¡Œæ”¶åˆ°é˜»å¡ï¼Œæˆç‚ºé˜»å¡ç‹€æ…‹ï¼Œä¹Ÿæˆç‚ºç­‰å¾…ç‹€æ…‹ã€‚

### ğŸ”– è¡Œç¨‹æ§åˆ¶è¡¨
![](pic/è¡Œç¨‹æ§åˆ¶è¡¨.jpg)
* è¡Œç¨‹ç‹€æ…‹(Process state)ï¼šrunningã€waiting
* ç¨‹å¼è¨ˆæ•¸å™¨(Program counter)ï¼šæŒ‡å‡ºè¡Œç¨‹æ¥è‘—è¦åŸ·è¡Œçš„æŒ‡ä»¤ä½å€
* CPUæš«å­˜å™¨(CPU registers)ï¼šæ‰€æœ‰æš«å­˜å™¨å…§å®¹
* CPUæ’ç­æ³•å‰‡ç›¸é—œè³‡è¨Š(CPU scheduling information)ï¼šè¡Œç¨‹çš„å„ªå…ˆé †åº (Priorities)ã€æ’ç­ä½‡åˆ—(scheduling queue)æŒ‡æ¨™ä»¥åŠå…¶å®ƒçš„æ’ç­åƒæ•¸
* è¨˜æ†¶é«”ç®¡ç†è³‡è¨Š(Memory-management information)ï¼šåˆ†é…çµ¦è¡Œç¨‹çš„è¨˜æ†¶é«”
å¸³è™Ÿè³‡è¨Š(Accounting information)ï¼šCPUå’Œå¯¦éš›æ™‚é–“çš„ä½¿ç”¨æ•¸é‡ã€æ™‚é™ã€å¸³è™Ÿå·¥ä½œæˆ–è¡Œç¨‹è™Ÿç¢¼ã€‚
* è¼¸å…¥/è¼¸å‡ºç‹€æ…‹è³‡è¨Š(I/O status information)ï¼šé…ç½®çµ¦è¡Œç¨‹çš„è¼¸å…¥/è¼¸å‡ºè£ç½®ï¼Œé–‹å•Ÿæª”æ¡ˆçš„ä¸²åˆ—

## ğŸ“– JVM & DVM
### ğŸ”– [JVM(Java Virtual Machine)](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/654140/)
* JVMæ˜¯é€šéåœ¨å¯¦éš›çš„è¨ˆç®—æ©Ÿä¸Šä»¿çœŸæ¨¡æ“¬å„ç¨®è¨ˆç®—æ©ŸåŠŸèƒ½ä¾†å¯¦ç¾çš„ã€‚ç”±ä¸€å¥—å­—ç¯€ç¢¼æŒ‡ä»¤é›†ã€ä¸€çµ„å¯„å­˜å™¨ã€ä¸€å€‹æ£§ã€ä¸€å€‹åƒåœ¾å›æ”¶å †å’Œä¸€å€‹å­˜å„²æ–¹æ³•åŸŸç­‰çµ„æˆã€‚JVMå±è”½äº†èˆ‡æ“ä½œç³»çµ±å¹³è‡ºç›¸é—œçš„ä¿¡æ¯ï¼Œä½¿å¾—Javaç¨‹åºåªéœ€è¦ç”Ÿæˆåœ¨Javaè™›æ“¬æ©Ÿä¸Šé‹è¡Œçš„ç›®æ¨™ä»£ç¢¼ï¼ˆå­—ç¯€ç¢¼ï¼‰ï¼Œå°±å¯åœ¨å¤šç¨®å¹³è‡ºä¸Šä¸åŠ ä¿®æ”¹çš„é‹è¡Œï¼Œé€™ä¹Ÿæ˜¯Javaèƒ½å¤ â€œä¸€æ¬¡ç·¨è­¯ï¼Œåˆ°è™•é‹è¡Œçš„â€åŸå› ã€‚

### ğŸ”– [DVM(Dalvik Virtual Machine)](https://ithelp.ithome.com.tw/articles/10011817)
* DVM(Dalvikè™›æ“¬æ©Ÿå™¨)æ˜¯ä¸€ç¨®æš«å­˜å™¨å‹æ…‹çš„è™›æ“¬æ©Ÿå™¨ã€‚ç°¡ç¨±DVMï¼ŒDVMåœ¨æ’°å¯«é–‹ç™¼æ™‚å°±å·²ç¶“è¨­æƒ³ç”¨æœ€å°‘çš„è¨˜æ†¶é«”è³‡æºä¾†åŸ·è¡Œï¼Œä»¥åŠåŒæ™‚å¯åŸ·è¡Œå¤šå€‹VMç‚ºå‰æä¾†é–‹ç™¼çš„ã€‚

### ğŸ”– [JVM & DVMçš„å·®ç•°](https://kknews.cc/zh-tw/tech/ql8yvo.html)
![](pic/dvm&jvm.png)
* 1.dvmåŸ·è¡Œçš„æ˜¯.dexæ ¼å¼æ–‡ä»¶ jvmåŸ·è¡Œçš„æ˜¯.classæ–‡ä»¶ androidç¨‹åºç·¨è­¯å®Œä¹‹å¾Œç”Ÿç”¢.classæ–‡ä»¶ï¼Œç„¶å¾Œï¼Œdexå·¥å…·æœƒæŠŠ.classæ–‡ä»¶è™•ç†æˆ.dexæ–‡ä»¶ï¼Œç„¶å¾ŒæŠŠè³‡æºæ–‡ä»¶å’Œ.dexæ–‡ä»¶ç­‰æ‰“åŒ…æˆ.apkæ–‡ä»¶ã€‚apkå°±æ˜¯android packageçš„æ„æ€ã€‚ jvmåŸ·è¡Œçš„æ˜¯.classæ–‡ä»¶ã€‚
* 2.dvmæ˜¯åŸºæ–¼å¯„å­˜å™¨çš„è™›æ“¬æ©Ÿ è€ŒjvmåŸ·è¡Œæ˜¯åŸºæ–¼è™›æ“¬æ£§çš„è™›æ“¬æ©Ÿã€‚å¯„å­˜å™¨å­˜å–é€Ÿåº¦æ¯”æ£§å¿«çš„å¤šï¼Œdvmå¯ä»¥æ ¹æ“šç¡¬é«”å¯¦ç¾æœ€å¤§çš„å„ªåŒ–ï¼Œæ¯”è¼ƒé©åˆç§»å‹•è¨­å‚™ã€‚
* 3..classæ–‡ä»¶å­˜åœ¨å¾ˆå¤šçš„å†—é¤˜ä¿¡æ¯ï¼Œdexå·¥å…·æœƒå»é™¤å†—é¤˜ä¿¡æ¯ï¼Œä¸¦æŠŠæ‰€æœ‰çš„.classæ–‡ä»¶æ•´åˆåˆ°.dexæ–‡ä»¶ä¸­ã€‚æ¸›å°‘äº†I/Oæ“ä½œï¼Œæé«˜äº†é¡çš„æŸ¥æ‰¾é€Ÿåº¦ã€‚

## ğŸ’» ç¨‹å¼å¯¦éš›æ“ä½œ
### ğŸ”— 08-posix/01-basic/task
![](pic/task.JPG)
<details>
  <summary><b>Show code</b></summary>

  ```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
    char *msg = argv[1];

    for (int i=0; i<5; i++) {
        printf("%d:%s\n", i, msg);
        sleep(1);
    }
    return 0;
}
  ```
</details>

#### The result of execution
```
user@user-myubuntu:~/sp/08-posix/01-basic$ gcc task.c -o task
user@user-myubuntu:~/sp/08-posix/01-basic$ ./task
0:(null)
1:(null)
2:(null)
3:(null)
4:(null)
user@user-myubuntu:~/sp/08-posix/01-basic$ ./task abc
0:abc
1:abc
2:abc
3:abc
4:abc
```

### ğŸ”— 08-posix/01-basic/vmem
![](pic/vmem.JPG)
<details>
  <summary><b>Show code</b></summary>

  ```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[]) {
    printf("location of code : %p\n", main);
    printf("location of heap : %p\n", malloc(100e6));
    int x = 3;
    printf("location of stack: %p\n", &x);
    return 0;
}
  ```
</details>

#### The result of execution
```
user@user-myubuntu:~/sp/08-posix/01-basic$ gcc vmem.c -o vmem
user@user-myubuntu:~/sp/08-posix/01-basic$ ./vmem
location of code : 0x561f89f72189
location of heap : 0x7f748937c010
location of stack: 0x7ffe37e684d4
```

### ğŸ”— 08-posix/01-basic/mem
![](pic/mem.JPG)
<details>
  <summary><b>Show code</b></summary>

  ```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int counter = 0;

int main(int argc, char *argv[]) {
    printf("(%d) addr of counter: %p\n", (int) getpid(), &counter);
    for (int i=0; i<5; i++) {
	    sleep(1);
	    counter = counter + 1;
	    printf("%d:(%d) value of counter: %d\n", i, getpid(), counter);
    }
    return 0;
}
  ```
</details>

#### The result of execution
```
user@user-myubuntu:~/sp/08-posix/01-basic$ gcc mem.c -o mem
user@user-myubuntu:~/sp/08-posix/01-basic$ ./mem
(2286) addr of counter: 0x557a6fada014
0:(2286) value of counter: 1
1:(2286) value of counter: 2
2:(2286) value of counter: 3
3:(2286) value of counter: 4
4:(2286) value of counter: 5
```

### ğŸ”— 08-posix/01-basic/mem0
![](pic/mem0.JPG)
<details>
  <summary><b>Show code</b></summary>

  ```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int counter;

int main(int argc, char *argv[]) {
    int *p = malloc(sizeof(int));
    printf("(%d) addr pointed to by p: %p\n", (int) getpid(), p);
    *p = 0;
    for (int i=0; i<5; i++) {
	    sleep(1);
	    *p = *p + 1;
	    printf("%d:(%d) value of p: %d\n", i, getpid(), *p);
    }
    return 0;
}
  ```
</details>

#### The result of execution
```
user@user-myubuntu:~/sp/08-posix/01-basic$ gcc mem0.c -o mem0
user@user-myubuntu:~/sp/08-posix/01-basic$ ./mem0
(2377) addr pointed to by p: 0x561afa75a2a0
0:(2377) value of p: 1
1:(2377) value of p: 2
2:(2377) value of p: 3
3:(2377) value of p: 4
4:(2377) value of p: 5
```

### ğŸ”— 08-posix/02-thread/georgeMary
![](pic/georgeMary.JPG)
<details>
  <summary><b>Show code</b></summary>

  ```
#include <pthread.h>     // å¼•ç”¨ pthread å‡½å¼åº«
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h> 

void *print_george(void *argu) {    // æ¯éš”ä¸€ç§’é˜å°å‡ºä¸€æ¬¡ George çš„å‡½æ•¸
  while (1) {    
    printf("George\n");    
    sleep(1);    
  }    
  return NULL;    
}    

void *print_mary(void *argu) {     // æ¯éš”2ç§’é˜å°å‡ºä¸€æ¬¡ Mary çš„å‡½æ•¸
  while (1) {    
    printf("Mary\n");    
    sleep(2);    
  }    
  return NULL;    
}    

int main() {     // ä¸»ç¨‹å¼é–‹å§‹
  pthread_t thread1, thread2;     // å®£å‘Šå…©å€‹åŸ·è¡Œç·’
  pthread_create(&thread1, NULL, &print_george, NULL);    // åŸ·è¡Œç·’ print_george
  pthread_create(&thread2, NULL, &print_mary, NULL);    // åŸ·è¡Œç·’ print_mary
  while (1) {     // ä¸»ç¨‹å¼æ¯éš”ä¸€ç§’é˜
    printf("----------------\n");    // å°±å°å‡ºåˆ†éš”è¡Œ
    sleep(1);     // åœæ­¢ä¸€ç§’é˜
  }    
  return 0;    
}
  ```
</details>

#### The result of execution
```
user@user-myubuntu:~/sp/08-posix/02-thread$ gcc georgeMary.c -o georgeMary -lpthread
user@user-myubuntu:~/sp/08-posix/02-thread$ ./georgeMary 
----------------
Mary
George
----------------
George
Mary
----------------
George
----------------
George
Mary
----------------
George
```
* -lpthread : -læ˜¯é€£çµå‡½ç¤ºåº«ï¼Œé€£çµpthreadå‡½ç¤ºåº«


## ğŸ“– è£œå……è³‡æ–™
* [HITCON å°ç£é§­å®¢å¹´æœƒ](https://hacker.org.tw/)
* [SITCON å­¸ç”Ÿè¨ˆç®—æ©Ÿå¹´æœƒ](https://sitcon.org/)


ğŸ–Šï¸editor : yi-chien Liu